<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Interactions </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Interactions ">
    <meta name="generator" content="docfx 2.51.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="interactions">Interactions</h1>

<p>This article will describe how to add fast serverside player interactions.
You can also use the interactions for something else then player interactions, but player interactions are the common usecase for them.</p>
<h2 id="setup-interactions">Setup Interactions</h2>
<p>First download the nuget package to access the interaction api's:
<a href="https://www.nuget.org/packages/AltV.Net.interactions">https://www.nuget.org/packages/AltV.Net.interactions</a></p>
<p>Next you need to init the interactions package. The best place to do this is when your resource is starting.</p>
<p>Note: It doesn't matter if your resource is a async resource. The code below is just for illustrating how to do it in general.</p>
<pre><code class="lang-csharp">public class MyResource: Resource
{
    public override void OnStart()
    {
      // (some code from you)
      AltInteractions.Init();
      // (some code from you)
    }
    
    public override void OnStop()
    {
      // (some code from you)
      AltInteractions.Dispose();
      // (some code from you)
    }
}
</code></pre>
<p>Now the interaction package setup is done and ready to be used.</p>
<h2 id="create-interactions">Create interactions</h2>
<p>To create a interaction you need to create a instance of it first.</p>
<p>This is how the default constructor looks like.</p>
<pre><code class="lang-csharp">var interaction = new Interaction(ulong type, ulong id, Vector3 position, int dimension, uint range);
</code></pre>
<p>The first parameter is the type. This defines the interaction type. A type can be anything you want to use it for. A example might be:
type 1 = house, type 2 = car shop, ect.</p>
<p>The second parameter is the id. This defines the interaction id for the given type. Only the id + type in combination needs to be unique.
You can have the same id used in different types. This is useful when you already have ids for houses and car shops and both have own auto incrementing counters starting at 1.</p>
<p>The third parameter is the position. This defines the position this interaction is present.</p>
<p>The fourth parameter is the dimension. This defines the dimension this interaction is visible inside. The dimension logic is the same as for players, vehicle ect.</p>
<pre><code>X can see only X
-X can see 0 and -X
0 can't see -X and X
</code></pre>
<p>And the fifth and last parameter is the range. This defines the range this interaction is usable in.</p>
<h2 id="add-interactions">Add Interactions</h2>
<p>To add a interaction to the system you can just call:</p>
<pre><code class="lang-csharp">AltInteractions.AddInteraction(interaction);
</code></pre>
<h2 id="remove-interactions">Remove Interactions</h2>
<p>To remove a interaction from the system you can just call:</p>
<pre><code class="lang-csharp">AltInteractions.RemoveInteraction(interaction);
</code></pre>
<h2 id="find-interactions">Find Interactions</h2>
<p>To find all interactions that are on a specific position and visible for a specific dimensions you can call:</p>
<pre><code class="lang-csharp">var interactions = await AltInteractions.FindInteractions(position, dimension);
</code></pre>
<p>As you can see on the code this method returns a task that needs to be awaited.</p>
<p>Now we have a list of all interactions that are visible at this specific dimension and are in range of the positions.
The returned object is null when no interactions are found.</p>
<pre><code class="lang-csharp"> foreach (var interaction in interactions)
 {
   // do stuff with interaction.Id and interaction.Type
 }
</code></pre>
<h2 id="create-custom-interactions">Create custom interactions</h2>
<p>You might want to add custom interactions to add custom data to them.</p>
<p>One example would be to add your house object to the interaction.</p>
<p>You have to add the default constructor when inherit from <code>Interaction</code></p>
<pre><code class="lang-csharp">public class HouseInteraction: Interaction 
{
    public HouseEntity House { get; }

    public HouseInteraction( HouseEntity house, ulong type, ulong id, Vector3 position, int dimension, uint range) : base(type, id,
            position, dimension, range)
    {
         House = house;
    }
}
</code></pre>
<p>Lets see how our interactions loop from above now looks like:</p>
<pre><code class="lang-csharp"> foreach (var interaction in interactions)
 {
   if (interaction is HouseInteraction houseInteraction) {
       // do something with houseInteraction.House
   }
 }
</code></pre>
<p>We can now get the house object from the interaction instead of using the interaction id and type to fetch it.
Note: You still should use the correct id and type to add and remove the interactions correctly.</p>
<h2 id="trigger-interactions">Trigger interactions</h2>
<p>With custom classes you can make use of another feature that is available.</p>
<p>The Interaction class has a abstract method you can override.</p>
<pre><code class="lang-csharp">public class HouseInteraction: Interaction 
{
    public HouseEntity House { get; }

    public HouseInteraction( HouseEntity house, ulong type, ulong id, Vector3 position, int dimension, uint range) : base(type, id,
            position, dimension, range)
    {
        House = house;
    }
    
    public override bool OnInteraction(IPlayer player, Vector3 interactionPosition, int interactionDimension)
    {
        // do something with the House obj
        return false;
    }
}
</code></pre>
<p>This method is getting triggered each time you call:</p>
<pre><code class="lang-csharp">AltInteractions.TriggerInteractions(player);
</code></pre>
<p>When you returns false from a interaction you allow other interactions that might be in range as well to also call OnInteraction.
When you return true, no other interaction will trigger.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/FabianTerhorst/coreclr-module/blob/master/docs/articles/interactions.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
